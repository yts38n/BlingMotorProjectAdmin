{"version":3,"file":"calendarControl.js","names":["calendarAvailable","document","querySelector","addEventListener","location","reload","inputNodeList","querySelectorAll","notAllowedCharacters","newCalendarNumber","failAlarm","forEach","node","date","dataset","toString","num","value","search","parseInt","isNaN","updateCalendarNumber","alert","getCalendar","targetYear","targetMonth","axios","post","blingMotorUserStatus","then","response","data","calendar","Calendar","renderCalendarControl","currentQueryYear","currentQueryMonth","calanderEventListeners","error","dateInnersNodeList","textDate","innerText","hasOwnProperty","disabled","renderItem","removeAttribute","innerHTML","newCalendar","patch"],"sources":["calendarControl.js"],"sourcesContent":["let calendarAvailable = {};\r\n\r\ndocument.querySelector('#resetEdit').addEventListener('click', () => {\r\n    location.reload();\r\n});\r\ndocument.querySelector('#confirmEdit').addEventListener('click', () => {\r\n    let inputNodeList = document.querySelectorAll('.form-control');\r\n    const notAllowedCharacters = /[^0-9]/;\r\n    let newCalendarNumber = {};\r\n    let failAlarm = false;\r\n    \r\n    inputNodeList.forEach(\r\n        (node) => {\r\n            let date = node.dataset.date.toString();\r\n            let num = (node.value.search(notAllowedCharacters) !== -1) ? null : parseInt(node.value);\r\n            if (num !== null && isNaN(num) !== true) {\r\n                newCalendarNumber[date] = num;\r\n            } else {\r\n                failAlarm = true;\r\n            }\r\n        }\r\n    )\r\n\r\n    if (failAlarm !== true) {\r\n        updateCalendarNumber(newCalendarNumber);\r\n    } else {\r\n        alert(\"只能輸入數字!! 請重新檢查!!\");\r\n    }\r\n})\r\n\r\nfunction getCalendar(targetYear, targetMonth) {\r\n    axios.post(`https://bling-motor-mock-server.onrender.com/api/v1/admin/calendar`, {\r\n            'data': {\r\n                'token': blingMotorUserStatus['userInfo']['userEmail'],\r\n                'calendar': {\r\n                    'year': targetYear.toString(),\r\n                    'month': targetMonth.toString(),\r\n                }\r\n            }\r\n        })\r\n        .then(response => {\r\n            calendarAvailable = response.data.data;\r\n            const calendar = new Calendar(calendarAvailable);\r\n            renderCalendarControl(calendarAvailable);\r\n\r\n            currentQueryYear = parseInt(calendarAvailable['year']);\r\n            currentQueryMonth = parseInt(calendarAvailable['month']);\r\n\r\n            calanderEventListeners(getCalendar);\r\n        })\r\n        .catch(error => {\r\n            alert(error.response.data.data['msg'])\r\n        });\r\n}\r\n\r\nfunction renderCalendarControl(calendarAvailable) {\r\n    let dateInnersNodeList = document.querySelectorAll('.dateInners');\r\n    dateInnersNodeList.forEach(\r\n        (node) => {\r\n            let date = node.dataset.date.toString();\r\n            let textDate = node.innerText;\r\n\r\n            if (calendarAvailable['dates'].hasOwnProperty(date)) {\r\n                let disabled = (calendarAvailable['dates'][date][\"available\"] !== true) ? 'disabled' : '';\r\n                let renderItem = `\r\n                    <div class=\"flex-grow-1\">${textDate}</div>\r\n                    <div class=\"numberBox\">\r\n                        <label for=\"\" class=\"form-label\">數量：</label>\r\n                        <input class=\"form-control\" type=\"number\" value='${calendarAvailable['dates'][date]['spaces']}' ${disabled} data-date='${date}'></input>\r\n                    </div>`;\r\n\r\n                node.removeAttribute('data-date');\r\n                node.innerHTML = renderItem;\r\n            } else {\r\n                node.innerHTML = '';\r\n            }\r\n        }\r\n    )\r\n}\r\n\r\nfunction updateCalendarNumber(newCalendar) {\r\n    axios.patch(`https://bling-motor-mock-server.onrender.com/api/v1/admin/calendar`, {\r\n        'data': {\r\n            'token': blingMotorUserStatus['userInfo']['userEmail'],\r\n            'newCalendar': {\r\n                'year': calendarAvailable['year'],\r\n                'month': calendarAvailable['month'],\r\n                'dates':newCalendar\r\n            }\r\n        }\r\n        })\r\n        .then(response => {\r\n            alert('修改成功!')\r\n            calendarAvailable = response.data.data;\r\n            const calendar = new Calendar(calendarAvailable);\r\n            renderCalendarControl(calendarAvailable);\r\n\r\n            currentQueryYear = parseInt(calendarAvailable['year']);\r\n            currentQueryMonth = parseInt(calendarAvailable['month']);\r\n\r\n            calanderEventListeners(getCalendar);\r\n        })\r\n        .catch(error => {\r\n            alert(error.response.data.data['msg'])\r\n        });\r\n}\r\n\r\ngetCalendar(currentQueryYear, currentQueryMonth);"],"mappings":"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"}